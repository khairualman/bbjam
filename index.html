<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>KitchenSink - Lungo 2.0</title>
    <meta name="description" content="">
    <meta name="author" content="Javier Jiménez Villar (@soyjavi)">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="cleartype" content="on">

    <link rel="stylesheet" href="css/lungo.css">
    <link rel="stylesheet" href="css/lungo.icon.brand.css">
    <link rel="stylesheet" href="css/lungo.icon.css">
    <link rel="stylesheet" href="css/lungo.theme.default.css">
</head>

<body class="app">

    <section id="main" data-transition="slide">
        <header class="">
            <nav class="left box">
                <a href="#features" data-router="aside" data-icon="menu"></a>
            </nav>
            <div class="left">
                <div class="centered title with-subtitle">
                    Lungo
                    <small class="subtitle">HTML5 Cross-Device Framework</small>
                </div>
            </div>
        </header>

        <article id="main-article" class="list indented scroll">
            <form>
                <input type="text" value="" placeholder="introduce aquí tu nombre" required="true" />
                <a href="#" id="enter-room" class="button big red">Comenzar</a>
            </form>
        </article>
    </section>


    <section id="game" data-transition="slide">

        <header class="">
            <nav class="left box">
                <a href="#" id="exit-room" data-icon="left"></a>
            </nav>
            <div class="left">
                <div class="centered title with-subtitle">
                    Lungo
                    <small class="subtitle">HTML5 Cross-Device Framework</small>
                </div>
            </div>
        </header>
        <article id="main-article" class="list indented scroll">
            el juego en si
        </article>
    </section>


    <!-- Lungo dependencies -->
    <script src="js/libs/quo.js"></script>
    <script src="js/libs/lungo.js"></script>
    <script src="js/libs/socket.io.js"></script>

    <!-- Lungo dependencies -->
    <script src="js/Instrument.js"></script>
    <script src="js/Instrument.Drum.js"></script>
    <script src="js/Instrument.Guitar.js"></script>
    <script src="js/Instrument.Keyboard.js"></script>
    <script src="js/Instrument.Bass.js"></script>

    <script>
        Lungo.init({
            name: 'JaM',
            version: '1.0',
            resources: []
        });

        var websocket = io.connect("http://192.168.18.118:6969");
        var room_data = {};
        var my_data = {};

        $$(document).ready(function() {

            $$("#exit-room").tap(function() {
                websocket.emit('exit_room', {
                    room_id: room_data.room_id,
                    name: my_data.user
                });
                Lungo.Router.back();
            });

            $$("#enter-room").tap(function() {
                my_data.user = $$(this).siblings('input').val();
                if(my_data.user != "") {
                    my_data = {
                        room_id: '1',
                        user: my_data.user,
                        instrument: 'banjo',
                        color: 'red'
                    };
                    websocket.emit('start', my_data);
                }
            });

        });

        websocket.on('start_in_room', function(data) {
            if(data.user == my_data.user) {
                room_data = data.room;
                Lungo.Router.section('#game');
                load_instrument(my_data.instrument);
            }else{}
        });


        var load_instrument = function(what) {
            switch(what) {
                default:
                    Instrument.Drum.init();
                    console.error("called");

            }
        };

    </script>

</body>
</html>